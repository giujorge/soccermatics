#' @include soccerPitchFG.R
NULL
#' Draws the average x,y-positions of all players in a dataframe and plots over
#' a soccer pitch.
#' 
#' @param df dataframe containing x,y-coordinates of player position in columns named \code{'x'} and \code{'y'}.
#' @param id_var character specifying the name of the column containing player identity. Defaults to \code{'id'}.
#' @param lengthPitch,widthPitch numeric, length and width of pitch in metres.
#' @param col1 character, fill colour of position points.
#' @param col2 character, border colour of position points.
#' @param size numeric, size of position points and text.
#' @param grass if TRUE, draws pitch background in green and lines in white. If FALSE, draws pitch background in white and lines in black.
#' @examples
#' \dontrun{
#' dat <- data(tromso)
#' # draw average player position of players
#' p <- soccerPositions(dat, lengthPitch = 105, widthPitch = 68, grass = TRUE)
#' # draw arrow showing direction of play
#' soccerDirection(p, "right", pitchLength = 105, pitchWidth = 68)
#' }
#' @seealso \code{\link{soccerPitchBG}} for a background soccer pitch for the purpose of drawing position maps, player trajectories, etc..
#' @export
soccerPositions <- function(df, id_var = "id", lengthPitch = 105, widthPitch = 68, col1 = "red", col2 = "white", size = 8, grass = FALSE) {
  # get average position of 11 players with most detected frames
  pos <- df %>%
    filter(x > 0 & x < lengthPitch & y > 0 & y < widthPitch) %>%
    group_by_(id_var) %>%
    summarise(x.mean = mean(x), y.mean = mean(y), n = n()) %>%
    arrange(desc(n)) %>%
    head(11)
  
  soccerPitchBG(lengthPitch = lengthPitch, widthPitch = widthPitch, grass = grass) +
    geom_point(data = pos, aes(x.mean, y.mean), shape = 21, size = size, fill = col1, colour = col2, stroke = 1.5) +
    geom_text(data = pos, aes(x.mean, y.mean, label=id), hjust=0.5, vjust=0.5, colour = col2, fontface = "bold", size = size - 4)
}
